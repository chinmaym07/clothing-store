{"ast":null,"code":"import _regeneratorRuntime from\"/home/skynet/react-practise/crown-clothing/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/home/skynet/react-practise/crown-clothing/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(getSnapshotFromUserAuth),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(signInWithGoogle),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(onGoogleSignInStart),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(signInWithEmail),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(onEmailSignInStart),_marked6=/*#__PURE__*/_regeneratorRuntime.mark(isUserAuthenticated),_marked7=/*#__PURE__*/_regeneratorRuntime.mark(oncheckUserSession),_marked8=/*#__PURE__*/_regeneratorRuntime.mark(signOut),_marked9=/*#__PURE__*/_regeneratorRuntime.mark(onSignOutStart),_marked10=/*#__PURE__*/_regeneratorRuntime.mark(signInAfterSignUp),_marked11=/*#__PURE__*/_regeneratorRuntime.mark(onSignUpSuccess),_marked12=/*#__PURE__*/_regeneratorRuntime.mark(signUp),_marked13=/*#__PURE__*/_regeneratorRuntime.mark(onSignUpStart),_marked14=/*#__PURE__*/_regeneratorRuntime.mark(userSagas);import{takeLatest,put,call,all}from\"redux-saga/effects\";import userActionTypes from\"./user.types\";import{auth,googleProvider,createUserProfileDocument,getCurrentUser}from\"../../firebase/firebase.utils\";import{signInSuccess,signInFailure,signOutSuccess,signOutFailure,signUpSuccess,signUpFailure}from\"./user.actions\";import UserActionTypes from\"./user.types\";export function getSnapshotFromUserAuth(userAuth,additionalData){var userRef,userSnapshot;return _regeneratorRuntime.wrap(function getSnapshotFromUserAuth$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return call(createUserProfileDocument,userAuth,additionalData);case 3:userRef=_context.sent;_context.next=6;return userRef.get();case 6:userSnapshot=_context.sent;_context.next=9;return put(signInSuccess(_objectSpread({id:userSnapshot.id},userSnapshot.data())));case 9:_context.next=15;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);_context.next=15;return put(signInFailure(_context.t0));case 15:case\"end\":return _context.stop();}}},_marked,null,[[0,11]]);}export function signInWithGoogle(){var _yield$auth$signInWit,user;return _regeneratorRuntime.wrap(function signInWithGoogle$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return auth.signInWithPopup(googleProvider);case 3:_yield$auth$signInWit=_context2.sent;user=_yield$auth$signInWit.user;_context2.next=7;return getSnapshotFromUserAuth(user);case 7:_context2.next=13;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](0);_context2.next=13;return put(signInFailure(_context2.t0));case 13:case\"end\":return _context2.stop();}}},_marked2,null,[[0,9]]);}export function onGoogleSignInStart(){return _regeneratorRuntime.wrap(function onGoogleSignInStart$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return takeLatest(userActionTypes.GOOGLE_SIGN_IN_START,signInWithGoogle);case 2:case\"end\":return _context3.stop();}}},_marked3);}export function signInWithEmail(_ref){var _ref$payload,email,password,_yield$auth$signInWit2,user;return _regeneratorRuntime.wrap(function signInWithEmail$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_ref$payload=_ref.payload,email=_ref$payload.email,password=_ref$payload.password;_context4.prev=1;_context4.next=4;return auth.signInWithEmailAndPassword(email,password);case 4:_yield$auth$signInWit2=_context4.sent;user=_yield$auth$signInWit2.user;_context4.next=8;return getSnapshotFromUserAuth(user);case 8:_context4.next=14;break;case 10:_context4.prev=10;_context4.t0=_context4[\"catch\"](1);_context4.next=14;return put(signInFailure(_context4.t0));case 14:case\"end\":return _context4.stop();}}},_marked4,null,[[1,10]]);}export function onEmailSignInStart(){return _regeneratorRuntime.wrap(function onEmailSignInStart$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return takeLatest(userActionTypes.EMAIL_SIGN_IN_START,signInWithEmail);case 2:case\"end\":return _context5.stop();}}},_marked5);}export function isUserAuthenticated(){var userAuth;return _regeneratorRuntime.wrap(function isUserAuthenticated$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;_context6.next=3;return getCurrentUser();case 3:userAuth=_context6.sent;if(userAuth){_context6.next=6;break;}return _context6.abrupt(\"return\");case 6:_context6.next=8;return getSnapshotFromUserAuth(userAuth);case 8:_context6.next=14;break;case 10:_context6.prev=10;_context6.t0=_context6[\"catch\"](0);_context6.next=14;return put(signInFailure());case 14:case\"end\":return _context6.stop();}}},_marked6,null,[[0,10]]);}export function oncheckUserSession(){return _regeneratorRuntime.wrap(function oncheckUserSession$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return takeLatest(userActionTypes.CHECK_USER_SESSION,isUserAuthenticated);case 2:case\"end\":return _context7.stop();}}},_marked7);}export function signOut(){return _regeneratorRuntime.wrap(function signOut$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.prev=0;_context8.next=3;return auth.signOut();case 3:_context8.next=5;return put(signOutSuccess());case 5:_context8.next=11;break;case 7:_context8.prev=7;_context8.t0=_context8[\"catch\"](0);_context8.next=11;return put(signOutFailure(_context8.t0));case 11:case\"end\":return _context8.stop();}}},_marked8,null,[[0,7]]);}export function onSignOutStart(){return _regeneratorRuntime.wrap(function onSignOutStart$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.next=2;return takeLatest(userActionTypes.SIGN_OUT_START,signOut);case 2:case\"end\":return _context9.stop();}}},_marked9);}export function signInAfterSignUp(_ref2){var _ref2$payload,user,additionalData;return _regeneratorRuntime.wrap(function signInAfterSignUp$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_ref2$payload=_ref2.payload,user=_ref2$payload.user,additionalData=_ref2$payload.additionalData;_context10.next=3;return getSnapshotFromUserAuth(user,additionalData);case 3:case\"end\":return _context10.stop();}}},_marked10);}export function onSignUpSuccess(){return _regeneratorRuntime.wrap(function onSignUpSuccess$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_context11.next=2;return takeLatest(UserActionTypes.SIGN_UP_SUCCESS,signInAfterSignUp);case 2:case\"end\":return _context11.stop();}}},_marked11);}export function signUp(_ref3){var _ref3$payload,email,password,displayName,_yield$auth$createUse,user;return _regeneratorRuntime.wrap(function signUp$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:_ref3$payload=_ref3.payload,email=_ref3$payload.email,password=_ref3$payload.password,displayName=_ref3$payload.displayName;_context12.prev=1;_context12.next=4;return auth.createUserWithEmailAndPassword(email,password);case 4:_yield$auth$createUse=_context12.sent;user=_yield$auth$createUse.user;_context12.next=8;return put(signUpSuccess({user:user,additionalData:{displayName:displayName}}));case 8:_context12.next=14;break;case 10:_context12.prev=10;_context12.t0=_context12[\"catch\"](1);_context12.next=14;return put(signUpFailure(_context12.t0));case 14:case\"end\":return _context12.stop();}}},_marked12,null,[[1,10]]);}export function onSignUpStart(){return _regeneratorRuntime.wrap(function onSignUpStart$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:_context13.next=2;return takeLatest(UserActionTypes.SIGN_UP_START,signUp);case 2:case\"end\":return _context13.stop();}}},_marked13);}export function userSagas(){return _regeneratorRuntime.wrap(function userSagas$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:_context14.next=2;return all([call(onGoogleSignInStart),call(onEmailSignInStart),call(isUserAuthenticated),call(onSignOutStart),call(onSignUpStart),call(onSignUpSuccess)]);case 2:case\"end\":return _context14.stop();}}},_marked14);}","map":{"version":3,"sources":["/home/skynet/react-practise/crown-clothing/client/src/redux/user/user.saga.js"],"names":["getSnapshotFromUserAuth","signInWithGoogle","onGoogleSignInStart","signInWithEmail","onEmailSignInStart","isUserAuthenticated","oncheckUserSession","signOut","onSignOutStart","signInAfterSignUp","onSignUpSuccess","signUp","onSignUpStart","userSagas","takeLatest","put","call","all","userActionTypes","auth","googleProvider","createUserProfileDocument","getCurrentUser","signInSuccess","signInFailure","signOutSuccess","signOutFailure","signUpSuccess","signUpFailure","UserActionTypes","userAuth","additionalData","userRef","get","userSnapshot","id","data","signInWithPopup","user","GOOGLE_SIGN_IN_START","payload","email","password","signInWithEmailAndPassword","EMAIL_SIGN_IN_START","CHECK_USER_SESSION","SIGN_OUT_START","SIGN_UP_SUCCESS","displayName","createUserWithEmailAndPassword","SIGN_UP_START"],"mappings":"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","sourcesContent":["import { takeLatest, put, call,all } from \"redux-saga/effects\";\nimport userActionTypes from \"./user.types\";\nimport {\n  auth,\n  googleProvider,\n  createUserProfileDocument,\n  getCurrentUser\n} from \"../../firebase/firebase.utils\";\n\nimport { signInSuccess, signInFailure ,signOutSuccess,signOutFailure, signUpSuccess , signUpFailure} from \"./user.actions\";\nimport UserActionTypes from \"./user.types\";\n\nexport function* getSnapshotFromUserAuth(userAuth,additionalData)\n{\n  try{\n    const userRef = yield call(createUserProfileDocument , userAuth,additionalData);\n    const userSnapshot = yield userRef.get();\n\n    yield put(signInSuccess({id:userSnapshot.id,...userSnapshot.data()}));\n  }catch (error) {\n    yield put(signInFailure(error));\n  }\n}\n\n\nexport function* signInWithGoogle() {\n  try {\n    const { user } = yield auth.signInWithPopup(googleProvider);\n    yield getSnapshotFromUserAuth(user);\n  }catch (error) {\n    yield put(signInFailure(error));\n  }\n    \n}\nexport function* onGoogleSignInStart() {\n  yield takeLatest(userActionTypes.GOOGLE_SIGN_IN_START, signInWithGoogle);\n}\n\n\n\n\nexport function* signInWithEmail({payload:{email , password}}) \n{\n  try\n  {\n    const { user }= yield auth.signInWithEmailAndPassword(email , password);\n    yield getSnapshotFromUserAuth(user);\n  }catch (error) {\n    yield put(signInFailure(error));\n  }\n}\nexport function* onEmailSignInStart() {\n  yield takeLatest(userActionTypes.EMAIL_SIGN_IN_START, signInWithEmail);\n}\n\nexport function* isUserAuthenticated()\n{\n  try{\n    const userAuth = yield getCurrentUser();\n    if(!userAuth) return;\n    yield getSnapshotFromUserAuth(userAuth);\n  }catch(error)\n  {\n    yield put(signInFailure());\n  }\n  \n}\n\nexport function* oncheckUserSession(){\n  yield takeLatest(userActionTypes.CHECK_USER_SESSION , isUserAuthenticated)\n}\n\nexport function* signOut()\n{\n  try {\n    yield auth.signOut();\n    yield put(signOutSuccess());\n  }catch(error)\n  {\n    yield put(signOutFailure(error));\n  }\n}\n\nexport function* onSignOutStart() {\n  yield takeLatest(userActionTypes.SIGN_OUT_START, signOut);\n}\n\n\nexport function* signInAfterSignUp({payload:{user , additionalData}}){\n  yield getSnapshotFromUserAuth(user , additionalData);\n}\n\nexport function* onSignUpSuccess(){\n  yield takeLatest(UserActionTypes.SIGN_UP_SUCCESS , signInAfterSignUp)\n}\n\n\nexport function* signUp({payload:{email , password , displayName}}){\n  try{\n    \n    const {user} = yield auth.createUserWithEmailAndPassword(email , password);\n    \n    yield put(signUpSuccess({user,additionalData:{displayName}}));\n    \n  }catch(error)\n  {\n    yield put(signUpFailure(error));\n  }\n\n}\n\n\nexport function* onSignUpStart() {\n  yield takeLatest(UserActionTypes.SIGN_UP_START,signUp)\n}\nexport function* userSagas()\n{\n    yield all([\n      call(onGoogleSignInStart),\n      call(onEmailSignInStart) ,\n      call(isUserAuthenticated),\n      call(onSignOutStart),\n      call(onSignUpStart),\n      call(onSignUpSuccess)\n    ]);\n}\n\n\n\n"]},"metadata":{},"sourceType":"module"}